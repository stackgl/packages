{"readme":"<h1 class=\"title\"><a target=\"_blank\" href=\"https://github.com/stackgl/glsl-parser\">glsl-parser</a><div class=\"contrib\"></div></h1>\n<p>\n\n\n</p>\n<p>A GLSL parser that takes tokens from\n<a href=\"http://github.com/stackgl/glsl-tokenizer\">glsl-tokenizer</a> and turns them into\nan AST.</p>\n<p>May either be used synchronously or as a stream.</p>\n<h2 id=\"api\">API</h2>\n<h3 id=\"stream-require-glsl-parser-stream-\"><code>stream = require(&apos;glsl-parser/stream&apos;)</code></h3>\n<p>Creates a GLSL parser stream, which emits nodes as they&apos;re parsed.</p>\n<pre><code class=\"lang-javascript\"><div class=\"line\"><span class=\"source js\"><span>var&#xA0;TokenStream&#xA0;=&#xA0;require(&apos;glsl-tokenizer/stream&apos;)</span></span></div><div class=\"line\"><span class=\"source js\"><span>var&#xA0;ParseStream&#xA0;=&#xA0;require(&apos;glsl-parser/stream&apos;)</span></span></div><div class=\"line\"><span class=\"source js\"><span>var&#xA0;fs&#xA0;=&#xA0;require(&apos;fs&apos;)</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span>fs.createReadStream(&apos;test.glsl&apos;)</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;.pipe(TokenStream())</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;.pipe(ParseStream())</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;.on(&apos;data&apos;,&#xA0;function(x)&#xA0;{</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;console.log(&apos;ast&#xA0;of&apos;,&#xA0;x.type)</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;})</span></span></div>\n</code></pre>\n<h3 id=\"ast-stream-program\"><code>ast = stream.program</code></h3>\n<p>The full program&apos;s AST, which will be updated with each incoming token.</p>\n<h3 id=\"ast-require-glsl-parser-direct-tokens-\"><code>ast = require(&apos;glsl-parser/direct&apos;)(tokens)</code></h3>\n<p>Synchronously parses an array of tokens from <code>glsl-tokenizer</code>.</p>\n<pre><code class=\"lang-javascript\"><div class=\"line\"><span class=\"source js\"><span>var&#xA0;TokenString&#xA0;=&#xA0;require(&apos;glsl-tokenizer/string&apos;)</span></span></div><div class=\"line\"><span class=\"source js\"><span>var&#xA0;ParseTokens&#xA0;=&#xA0;require(&apos;glsl-parser/direct&apos;)</span></span></div><div class=\"line\"><span class=\"source js\"><span>var&#xA0;fs&#xA0;=&#xA0;require(&apos;fs&apos;)</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span>var&#xA0;src&#xA0;=&#xA0;fs.readFileSync(&apos;test.glsl&apos;,&#xA0;&apos;utf8&apos;)</span></span></div><div class=\"line\"><span class=\"source js\"><span>var&#xA0;tokens&#xA0;=&#xA0;TokenString(src)</span></span></div><div class=\"line\"><span class=\"source js\"><span>var&#xA0;ast&#xA0;=&#xA0;ParseTokens(tokens)</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span>console.log(ast)</span></span></div>\n</code></pre>\n<h2 id=\"nodes\">Nodes</h2>\n<ul>\n<li><code>stmtlist</code></li>\n<li><code>stmt</code></li>\n<li><code>struct</code></li>\n<li><code>function</code></li>\n<li><code>functionargs</code></li>\n<li><code>decl</code></li>\n<li><code>decllist</code></li>\n<li><code>forloop</code></li>\n<li><code>whileloop</code></li>\n<li><code>if</code></li>\n<li><code>expr</code></li>\n<li><code>precision</code></li>\n<li><code>comment</code></li>\n<li><code>preprocessor</code></li>\n<li><code>keyword</code></li>\n<li><code>ident</code></li>\n<li><code>return</code></li>\n<li><code>continue</code></li>\n<li><code>break</code></li>\n<li><code>discard</code></li>\n<li><code>do-while</code></li>\n<li><code>binary</code></li>\n<li><code>ternary</code></li>\n<li><code>unary</code></li>\n</ul>\n<h2 id=\"known-issues\">Known Issues</h2>\n<ul>\n<li><p>because i am not smart enough to write a fully streaming parser, the current parser &quot;cheats&quot; a bit when it encounters a <code>expr</code> node! it actually waits until it has all the tokens it needs to build a tree for a given expression, then builds it and emits the constituent child nodes in the expected order. the <code>expr</code> parsing is heavily influenced by <a href=\"http://javascript.crockford.com/tdop/tdop.html\">crockford&apos;s tdop article</a>. the rest of the parser is heavily influenced by fever dreams.</p>\n</li>\n<li><p>the parser might hit a state where it&apos;s looking at what <em>could be</em> an expression, or it could be a declaration --\nthat is, the statement starts with a previously declared <code>struct</code>. it&apos;ll opt to pretend it&apos;s a declaration, but that\nmight not be the case -- it might be a user-defined constructor starting a statement!</p>\n</li>\n<li><p>&quot;unhygenic&quot; <code>#if</code> / <code>#endif</code> macros are completely unhandled at the moment, since they&apos;re a bit of a pain.\nif you&apos;ve got unhygenic macros in your code, move the #if / #endifs to statement level, and have them surround\nwholly parseable code. this sucks, and i am sorry.</p>\n</li>\n</ul>\n<h2 id=\"license\">License</h2>\n<p>MIT, see <a href=\"http://github.com/stackgl/glsl-parser/blob/master/LICENSE.md\">LICENSE.md</a> for more details.</p>\n"}