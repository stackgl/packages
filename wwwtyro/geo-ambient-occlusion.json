{"readme":"<h1 class=\"title\"><a target=\"_blank\" href=\"https://github.com/wwwtyro/geo-ambient-occlusion\">geo-ambient-occlusion</a><div class=\"contrib\"></div></h1>\n<p>Generates a per-vertex ambient occlusion array for arbitrary meshes.</p>\n<p align=\"center\">\n  <iframe scrolling=\"no\" seamless=\"seamless\" src=\"http://wwwtyro.github.io/geo-ambient-occlusion/\"></iframe>\n</p>\n\n<p><a href=\"https://wwwtyro.github.io/geo-ambient-occlusion/\">Demo</a></p>\n<h3 id=\"support-notes\">Support notes</h3>\n<ul>\n<li>Requires the <code>OES_texture_float</code> extension.</li>\n<li><a href=\"https://bugs.webkit.org/show_bug.cgi?id=171432\">Currently unsupported by Safari</a>.</li>\n</ul>\n<h2 id=\"how-does-it-work-\">How does it work?</h2>\n<p><code>geo-ambient-occlusion</code> renders multiple shadow maps for your mesh from random viewpoints. It averages the occlusion\nfor each vertex across all the shadow maps to calculate an ambient occlusion value for each. This data is converted\ninto a <code>Float32Array</code> of occlusion values and returned to you for immediate use as an attribute in your shader program.</p>\n<p><code>geo-ambient-occlusion</code> is built on top of the disgustingly good <a href=\"https://github.com/regl-project/regl\">regl</a> WebGL\nlibrary.</p>\n<h2 id=\"install\">Install</h2>\n<pre><code class=\"lang-sh\"><div class=\"line\"><span class=\"source shell\"><span>npm&#xA0;install&#xA0;geo-ambient-occlusion</span></span></div>\n</code></pre>\n<h2 id=\"example\">Example</h2>\n<pre><code class=\"lang-js\"><div class=\"line\"><span class=\"source js\"><span>let&#xA0;dragon&#xA0;=&#xA0;require(&apos;stanford-dragon/2&apos;);</span></span></div><div class=\"line\"><span class=\"source js\"><span>const&#xA0;geoao&#xA0;=&#xA0;require(&apos;geo-ambient-occlusion&apos;);</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span>const&#xA0;aoSampler&#xA0;=&#xA0;geoao(dragon.positions,&#xA0;{&#xA0;cells:&#xA0;dragon.cells&#xA0;});</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span>for&#xA0;(let&#xA0;i&#xA0;=&#xA0;0;&#xA0;i&#xA0;&lt;&#xA0;256;&#xA0;i++)&#xA0;{</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;aoSampler.sample();</span></span></div><div class=\"line\"><span class=\"source js\"><span>}</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span>const&#xA0;ao&#xA0;=&#xA0;aoSampler.report();</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span>aoSampler.dispose();</span></span></div>\n</code></pre>\n<h2 id=\"api\">API</h2>\n<h4 id=\"const-geoao-require-geo-ambient-occlusion-\"><code>const geoao = require(&apos;geo-ambient-occlusion&apos;)</code></h4>\n<h3 id=\"constructor\">Constructor</h3>\n<h4 id=\"const-aosampler-geoao-positions-opts-\"><code>const aoSampler = geoao(positions[, opts])</code></h4>\n<p><code>positions</code> is the vertex array for your mesh. It can be any of:</p>\n<ul>\n<li>Flat array <code>[1,2,3,4,5,6]</code></li>\n<li>Array of arrays <code>[[1,2,3], [4,5,6]]</code></li>\n<li>Array of TypedArrays <code>[new Float32Array([1,2,3]), new Float32Array([4,5,6])]</code></li>\n<li>TypedArray <code>new Float32Array([1,2,3,4,5,6])</code></li>\n<li><a href=\"https://www.npmjs.com/package/ndarray\">ndarray</a> <code>ndarray(new Float32Array([1,2,3,4,5,6]))</code></li>\n</ul>\n<p><code>opts</code> is an object that can have the following properties:</p>\n<ul>\n<li><code>resolution</code> (int) is the resolution to build the depth buffer at. Defaults to <code>512</code>.</li>\n<li><code>bias</code> (float) is the bias applied to the shadow map while building the ambient occlusion data. Defaults to <code>0.01</code>.</li>\n<li><code>cells</code> is the index data for your mesh, if you&apos;re using a <a href=\"https://github.com/mikolalysenko/simplicial-complex\">simplicial complex</a>. Defaults to <code>undefined</code>.</li>\n<li><code>normals</code> are per-vertex normals, either in an array or array of arrays. If not supplied, they will be computed using the <a href=\"https://www.npmjs.com/package/normals\">normals</a> npm module.</li>\n<li><code>regl</code> is an optional <a href=\"https://github.com/regl-project/regl\">regl</a> context you can provide to reduced the overhead of\nmultiple WebGL contexts. This context will need to have the <code>OES_texture_float</code> extension enabled, and depending on the\nsize of your mesh, also the <code>OES_element_index_uint</code> extension.</li>\n</ul>\n<h3 id=\"methods\">Methods</h3>\n<h4 id=\"aosampler-sample-\"><code>aoSampler.sample()</code></h4>\n<p>Collects a single sample of ambient occlusion data. Run this several hundred times to reach a useful average.</p>\n<h4 id=\"const-ao-aosampler-report-\"><code>const ao = aoSampler.report()</code></h4>\n<p>Returns the average ambient occlusion, per vertex, sampled so far. Format is a <code>Float32Array</code>.</p>\n<h4 id=\"aosampler-dispose-\"><code>aoSampler.dispose()</code></h4>\n<p>Disposes of all resources used for this sampling. Does not dispose of the internal <code>regl</code> context if it was provided by\nthe user. Behavior of <code>aoSampler</code> after calling this function is undefined.</p>\n"}