{"readme":"<h1 class=\"title\"><a target=\"_blank\" href=\"https://github.com/rreusser/glsl-fft\">glsl-fft</a><div class=\"contrib\"></div></h1>\n<blockquote>\n<p>GLSL setup for a <a href=\"https://en.wikipedia.org/wiki/Fast_Fourier_transform\">Fast Fourier Transform</a> of two complex matrices</p>\n</blockquote>\n<iframe scrolling=\"no\" seamless=\"seamless\" src=\"https://rreusser.github.io/glsl-fft/\"></iframe><h2 id=\"installation\">Installation</h2>\n<pre><code class=\"lang-sh\"><div class=\"line\"><span class=\"source shell\"><span>$&#xA0;npm&#xA0;install&#xA0;glsl-fft</span></span></div>\n</code></pre>\n<h2 id=\"example\">Example</h2>\n<pre><code class=\"lang-javascript\"><div class=\"line\"><span class=\"source js\"><span>var&#xA0;fft&#xA0;=&#xA0;require(&apos;glsl-fft&apos;);</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span>//&#xA0;Set&#xA0;up&#xA0;a&#xA0;forward&#xA0;transform:</span></span></div><div class=\"line\"><span class=\"source js\"><span>var&#xA0;forwardTransform&#xA0;=&#xA0;fft({</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;width:&#xA0;4,</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;height:&#xA0;2,</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;input:&#xA0;&apos;a&apos;,</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;ping:&#xA0;&apos;b&apos;,</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;pong:&#xA0;&apos;c&apos;,</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;output:&#xA0;&apos;d&apos;,</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;forward:&#xA0;true,</span></span></div><div class=\"line\"><span class=\"source js\"><span>});</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span>//&#xA0;Output&#xA0;is&#xA0;a&#xA0;list&#xA0;of&#xA0;passes:</span></span></div><div class=\"line\"><span class=\"source js\"><span>//&#xA0;=&gt;&#xA0;[</span></span></div><div class=\"line\"><span class=\"source js\"><span>//&#xA0;&#xA0;{input:&#xA0;&apos;a&apos;,&#xA0;output:&#xA0;&apos;c&apos;,&#xA0;horizontal:&#xA0;true,&#xA0;forward:&#xA0;true,&#xA0;resolution:&#xA0;[&#xA0;0.25,&#xA0;0.5&#xA0;],&#xA0;normalization:&#xA0;1,&#xA0;subtransformSize:&#xA0;2},</span></span></div><div class=\"line\"><span class=\"source js\"><span>//&#xA0;&#xA0;{input:&#xA0;&apos;c&apos;,&#xA0;output:&#xA0;&apos;b&apos;,&#xA0;horizontal:&#xA0;true,&#xA0;forward:&#xA0;true,&#xA0;resolution:&#xA0;[&#xA0;0.25,&#xA0;0.5&#xA0;],&#xA0;normalization:&#xA0;1,&#xA0;subtransformSize:&#xA0;4},</span></span></div><div class=\"line\"><span class=\"source js\"><span>//&#xA0;&#xA0;{input:&#xA0;&apos;b&apos;,&#xA0;output:&#xA0;&apos;d&apos;,&#xA0;horizontal:&#xA0;false,&#xA0;forward:&#xA0;true,&#xA0;resolution:&#xA0;[&#xA0;0.25,&#xA0;0.5&#xA0;],&#xA0;normalization:&#xA0;1,&#xA0;subtransformSize:&#xA0;2}</span></span></div><div class=\"line\"><span class=\"source js\"><span>//&#xA0;]</span></span></div>\n</code></pre>\n<p>Usage of the GLSL fragment shader using the above parameters as uniforms:</p>\n<pre><code class=\"lang-glsl\"><div class=\"line\"><span class=\"source glsl\"><span>precision&#xA0;highp&#xA0;</span><span class=\"storage type glsl\"><span>float</span></span><span>;</span></span></div><div class=\"line\"><span class=\"source glsl\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source glsl\"><span>#</span><span class=\"meta preprocessor keyword import define glsl\"><span>pragma&#xA0;glslify:</span></span><span class=\"entity name function glsl\"><span>&#xA0;fft&#xA0;</span></span><span class=\"operator glsl\"><span>=&#xA0;</span></span><span class=\"keyword operator glsl\"><span>require</span></span><span>(</span><span class=\"string quoted double\"><span>glsl-fft</span></span><span>)</span><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source glsl\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source glsl\"><span class=\"storage modifier glsl\"><span>uniform</span></span><span>&#xA0;</span><span class=\"storage type glsl\"><span>sampler2D</span></span><span>&#xA0;src;</span></span></div><div class=\"line\"><span class=\"source glsl\"><span class=\"storage modifier glsl\"><span>uniform</span></span><span>&#xA0;</span><span class=\"storage type glsl\"><span>vec2</span></span><span>&#xA0;resolution;</span></span></div><div class=\"line\"><span class=\"source glsl\"><span class=\"storage modifier glsl\"><span>uniform</span></span><span>&#xA0;</span><span class=\"storage type glsl\"><span>float</span></span><span>&#xA0;subtransformSize,&#xA0;normalization;</span></span></div><div class=\"line\"><span class=\"source glsl\"><span class=\"storage modifier glsl\"><span>uniform</span></span><span>&#xA0;</span><span class=\"storage type glsl\"><span>bool</span></span><span>&#xA0;horizontal,&#xA0;forward;</span></span></div><div class=\"line\"><span class=\"source glsl\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source glsl\"><span class=\"storage type glsl\"><span>void</span></span><span class=\"meta function c\"><span class=\"punctuation whitespace function leading c\"><span>&#xA0;</span></span><span class=\"entity name function c\"><span>main</span></span><span>&#xA0;</span><span class=\"meta parens c\"><span class=\"punctuation section parens begin c\"><span>(</span></span><span class=\"punctuation section parens end c\"><span>)</span></span></span><span>&#xA0;</span><span class=\"meta block c\"><span class=\"punctuation section block begin c\"><span>{</span></span></span></span></span></div><div class=\"line\"><span class=\"source glsl\"><span class=\"meta function c\"><span class=\"meta block c\"><span>&#xA0;&#xA0;</span><span class=\"support variable glsl\"><span>gl_FragColor</span></span><span>&#xA0;=</span><span class=\"meta function-call c\"><span class=\"punctuation whitespace function-call leading c\"><span>&#xA0;</span></span><span class=\"support function any-method c\"><span>fft</span></span><span>(</span></span><span>src,&#xA0;resolution,&#xA0;subtransformSize,&#xA0;horizontal,&#xA0;forward,&#xA0;normalization);</span></span></span></span></div><div class=\"line\"><span class=\"source glsl\"><span class=\"meta function c\"><span class=\"meta block c\"><span class=\"punctuation section block end c\"><span>}</span></span></span></span></span></div>\n</code></pre>\n<p>See <a href=\"http://github.com/rreusser/glsl-fft/blob/master/./example/index.js\">example/index.js</a> for a fully worked angular <a href=\"https://en.wikipedia.org/wiki/Gaussian_blur\">Gaussian blur</a> example using <a href=\"https://github.com/regl-project/regl\">regl</a>.</p>\n<h2 id=\"usage\">Usage</h2>\n<h3 id=\"what-does-it-compute-\">What does it compute?</h3>\n<p>This shader computes the 2D <a href=\"https://en.wikipedia.org/wiki/Fast_Fourier_transform\">Fast Fourier Transform</a> of two complex input matrices contained in a single four-channel floating point (or half float) WebGL texture. The red and green channels contain the real and imaginary components of the first matrix, while the blue and alpha channels contain the real and imaginary components of the second matrix. The results match and are tested against <a href=\"https://github.com/scijs/ndarray-fft\">ndarray-fft</a>.</p>\n<h3 id=\"what-is-required-\">What is required?</h3>\n<p>This module does not interface with WebGL or have WebGL-specific peer dependencies. It only performs the setup work and exposes a fragment shader that performs the Fourier transform.</p>\n<p>This module is designed for use with <a href=\"https://github.com/glslify/glslify\">glslify</a>, though it&apos;s not required. It also works relatively effortlessly with <a href=\"https://github.com/regl-project/regl\">regl</a>, though that&apos;s also not required. At minimum, you&apos;ll need no less than two float or half-float WebGL framebuffers, including input, output, and two buffers to ping-pong back and forth between during the passes. The ping-pong framebuffers may include the input and output framebuffers as long as the parity of the number of steps permits the final output without requiring an extra copy operation.</p>\n<p>The size of the textures must be a power of two, but not necessarily square.</p>\n<h3 id=\"is-it-fast-\">Is it fast?</h3>\n<p>As far as fast Fourier transforms go, it&apos;s not really optimized at all, though it&apos;s faster than transferring data to and from the GPU each time you need to compute a Fourier transform. The biggest strike against it is the number of passes. That could be optimized, but I don&apos;t currently have the time. Would gladly accept a PR though.</p>\n<h2 id=\"javascript-api\">JavaScript API</h2>\n<h3 id=\"require-glsl-fft-options-\"><code>require(&apos;glsl-fft&apos;)(options)</code></h3>\n<p>Perform the setup work required to use the FFT kernel in the fragment shader, <code>index.glsl</code>. Input arguments are:</p>\n<ul>\n<li><code>input</code> (<code>Any</code>): An identifier or object for the input framebuffer.</li>\n<li><code>output</code> (<code>Any</code>): An identifier or object for the final output framebuffer.</li>\n<li><code>ping</code> (<code>Any</code>): An identifier or object for the first ping-pong framebuffer.</li>\n<li><code>pong</code> (<code>Any</code>): An identifier or object for the second ping-pong framebuffer.</li>\n<li><code>forward</code> (<code>Boolean</code>): <code>true</code> if the transform is in the forward direction.</li>\n<li><code>size</code> (<code>Number</code>): size of the input, equal to the <code>width</code> and <code>height</code>. Must be a power of two.</li>\n<li><code>width</code> (<code>Number</code>): width of the input. Must be a power of two. Ignored if <code>size</code> is specified.</li>\n<li><code>height</code> (<code>Number</code>): height of the input. Must be a power of two. Ignored if <code>size</code> is specifid.</li>\n<li><code>splitNormalization</code>: (<code>Boolean</code>): If <code>true</code>, normalize by <code>1 / &#x221A;(width * height)</code> on both the forward and inverse transforms. If <code>false</code>, normalize by <code>1 / (width * height)</code> on only the inverse transform. Default is <code>true</code>. Provided to avoid catastrophic overflow during the forward transform when using half-float textures. One-way transforms will match <a href=\"https://github.com/scijs/ndarray-fft\">ndarray-fft</a> only if <code>false</code>.</li>\n</ul>\n<p>Returns a list of passes. Each object in the list is a set of parameters that must either be used to bind the correct framebuffers or passed as uniforms to the fragment shader.</p>\n<h2 id=\"glsl-api\">GLSL API</h2>\n<h3 id=\"-pragma-glslify-fft-require-glsl-fft-\"><code>#pragma glslify: fft = require(glsl-fft)</code></h3>\n<h3 id=\"vec4-fft-sampler2d-src-vec2-resolution-float-subtransformsize-bool-horizontal-bool-forward-float-normalization-\"><code>vec4 fft(sampler2D src, vec2 resolution, float subtransformSize, bool horizontal, bool forward, float normalization)</code></h3>\n<p>Returns the <code>gl_FragColor</code> in order to perform a single pass of the FFT comptuation. Uniforms map directly to the output of the JavaScript setup function, with the exception of <code>src</code> which is a <code>sampler2D</code> for the input framebuffer or texture.</p>\n<h3 id=\"-pragma-glslify-wavenumber-require-glsl-fft-wavenumber-\"><code>#pragma glslify: wavenumber = require(glsl-fft/wavenumber)</code></h3>\n<h3 id=\"vec2-wavenumber-vec2-resolution-\"><code>vec2 wavenumber(vec2 resolution)</code></h3>\n<h3 id=\"vec2-wavenumber-vec2-resolution-float-dxy-\"><code>vec2 wavenumber(vec2 resolution, float dxy)</code></h3>\n<h3 id=\"vec2-wavenumber-vec2-resolution-vec2-dxy-\"><code>vec2 wavenumber(vec2 resolution, vec2 dxy)</code></h3>\n<p>Parameters are:</p>\n<ul>\n<li><code>resolution</code>: a <code>vec2</code> containing <code>1 / width</code> and <code>1 / height</code>.</li>\n<li><code>dxy</code> (optional): Either a float representing the sample spacing in either direction, or a <code>vec2</code> representing the sample spacing in the horizontal and vertical directions, respectively.</li>\n</ul>\n<p>Returns <code>vec2(kx, ky)</code>, where <code>kx</code> and <code>ky</code> are the angular wavenumbers of the corresponding texel of the Fourier Transformed data.</p>\n<h2 id=\"see-also\">See also</h2>\n<ul>\n<li><a href=\"https://github.com/scijs/ndarray-fft\">ndarray-fft</a></li>\n<li><a href=\"https://github.com/rreusser/glsl-rfft\">glsl-rfft</a></li>\n</ul>\n<h2 id=\"license\">License</h2>\n<p>&#xA9; Ricky Reusser 2017. MIT License. Based on the <a href=\"https://github.com/dli/filtering\">filtering example</a> of David Li. See LICENSE for more details.</p>\n"}