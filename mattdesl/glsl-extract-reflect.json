{"readme":"<h1 class=\"title\"><a target=\"_blank\" href=\"https://github.com/mattdesl/glsl-extract-reflect\">glsl-extract-reflect</a><div class=\"contrib\"></div></h1>\n<p><a href=\"http://github.com/badges/stability-badges\"></a></p>\n<p>Takes the type data from <a href=\"https://www.npmjs.com/package/glsl-extract\">glsl-extract</a> and transforms the names into a JSON structure where each leaf node is the return value of the given <code>map</code> function.</p>\n<p>This is useful to create wrappers for uniform and attribute structs/arrays.</p>\n<pre><code class=\"lang-js\"><div class=\"line\"><span class=\"source js\"><span>var&#xA0;reflect&#xA0;=&#xA0;require(&apos;glsl-extract-reflect&apos;)</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span>var&#xA0;uniforms&#xA0;=&#xA0;[</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;{&#xA0;name:&#xA0;&apos;lights[0].position&apos;,&#xA0;type:&#xA0;&apos;vec4&apos;&#xA0;},</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;{&#xA0;name:&#xA0;&apos;projection&apos;,&#xA0;type:&#xA0;&apos;mat4&apos;&#xA0;},</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;{&#xA0;name:&#xA0;&apos;color&apos;,&#xA0;type:&#xA0;&apos;vec3&apos;&#xA0;}</span></span></div><div class=\"line\"><span class=\"source js\"><span>]</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;</span></span></div><div class=\"line\"><span class=\"source js\"><span>var&#xA0;locations&#xA0;=&#xA0;reflect(uniforms,&#xA0;function&#xA0;(uniform)&#xA0;{</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;return&#xA0;{</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;type:&#xA0;uniform.type,</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;location:&#xA0;gl.getUniformLocation(program,&#xA0;uniform.path)</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;}</span></span></div><div class=\"line\"><span class=\"source js\"><span>})</span></span></div>\n</code></pre>\n<p>The <code>locations</code> result looks like this:</p>\n<pre><code class=\"lang-js\"><div class=\"line\"><span class=\"source js\"><span>{</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&quot;lights&quot;:&#xA0;[</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;{</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&quot;position&quot;:&#xA0;{</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&quot;type&quot;:&#xA0;&quot;vec4&quot;,</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&quot;location&quot;:&#xA0;WebGLUniformLocation</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;}</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;}</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;],</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&quot;projection&quot;:&#xA0;{</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;&quot;type&quot;:&#xA0;&quot;mat4&quot;,</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;&quot;location&quot;:&#xA0;WebGLUniformLocation</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;},</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&quot;color&quot;:&#xA0;{</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;&quot;type&quot;:&#xA0;&quot;vec3&quot;,</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;&#xA0;&#xA0;&quot;location&quot;:&#xA0;WebGLUniformLocation</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;}</span></span></div><div class=\"line\"><span class=\"source js\"><span>}</span></span></div>\n</code></pre>\n<p>Credit goes to @mikolalysenko; this was pulled out of <a href=\"https://github.com/stackgl/gl-shader\">gl-shader</a> and made a little more generic.</p>\n<h2 id=\"usage\">Usage</h2>\n<p><a href=\"https://www.npmjs.com/package/glsl-extract-reflect\"></a></p>\n<h4 id=\"result-reflect-array-map-\"><code>result = reflect(array, map)</code></h4>\n<p>Takes an <code>array</code> of uniforms or attributes with <code>{ name, type }</code> values, and returns the &quot;unflattened&quot; object for all structs and arrays. Each leaf node is the result of calling <code>map(data, index, array)</code>, where <code>data</code> has the following:</p>\n<pre><code class=\"lang-js\"><div class=\"line\"><span class=\"source js\"><span>{</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;name:&#xA0;&apos;radius&apos;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;the&#xA0;standalone&#xA0;uniform&#xA0;name</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;path:&#xA0;&apos;lights[0].radius&apos;&#xA0;//&#xA0;the&#xA0;qualified&#xA0;name&#xA0;used&#xA0;by&#xA0;WebGL</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;type:&#xA0;&apos;float&apos;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;//&#xA0;the&#xA0;original&#xA0;type</span></span></div><div class=\"line\"><span class=\"source js\"><span>&#xA0;&#xA0;...</span></span></div><div class=\"line\"><span class=\"source js\"><span>}</span></span></div>\n</code></pre>\n<p>Other values (like <code>location</code>) are also copied into the <code>data</code> object.</p>\n<h2 id=\"see-also\">See Also</h2>\n<ul>\n<li><a href=\"https://www.npmjs.com/package/glsl-extract-sync\">glsl-extract-sync</a></li>\n<li><a href=\"https://www.npmjs.com/package/gl-shader-extract\">gl-shader-extract</a> (extracts during runtime)</li>\n</ul>\n<h2 id=\"license\">License</h2>\n<p>MIT, see <a href=\"http://github.com/mattdesl/glsl-extract-reflect/blob/master/LICENSE.md\">LICENSE.md</a> for details.</p>\n"}